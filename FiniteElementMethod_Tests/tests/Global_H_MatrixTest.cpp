#include "pch.h"

#include "gtest/gtest.h"

#include "Simulation.h"

static const double EPSILON = 1e-3;

static double globalHMatrixFixture[16][16] = {
    { 23.3333, -2.5, 0, 0, -2.5, -8.33333, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
    { -2.5, 40, -2.5, 0, -8.33333, -8.33333, -8.33333, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
    { 0, -2.5, 40, -2.5, 0, -8.33333, -8.33333, -8.33333, 0, 0, 0, 0, 0, 0, 0, 0 },
    { 0, 0, -2.5, 23.3333, 0, 0, -8.33333, -2.5, 0, 0, 0, 0, 0, 0, 0, 0 },
    { -2.5, -8.33333, 0, 0, 40, -8.33334, 0, 0, -2.5, -8.33333, 0, 0, 0, 0, 0, 0 },
    { -8.33333, -8.33333, -8.33333, 0, -8.33334, 66.6667, -8.33333, 0, -8.33333, -8.33333, -8.33333, 0, 0, 0, 0, 0 },
    { 0, -8.33333, -8.33333, -8.33333, 0, -8.33333, 66.6667, -8.33333, 0, -8.33333, -8.33333, -8.33333, 0, 0, 0, 0 },
    { 0, 0, -8.33333, -2.5, 0, 0, -8.33333, 40, 0, 0, -8.33333, -2.5, 0, 0, 0, 0 },
    { 0, 0, 0, 0, -2.5, -8.33333, 0, 0, 40, -8.33333, 0, 0, -2.5, -8.33333, 0, 0 },
    { 0, 0, 0, 0, -8.33333, -8.33333, -8.33333, 0, -8.33333, 66.6667, -8.33333, 0, -8.33333, -8.33333, -8.33333, 0 },
    { 0, 0, 0, 0, 0, -8.33333, -8.33333, -8.33333, 0, -8.33333, 66.6667, -8.33333, 0, -8.33333, -8.33334, -8.33333 },
    { 0, 0, 0, 0, 0, 0, -8.33333, -2.5, 0, 0, -8.33333, 40, 0, 0, -8.33333, -2.5 },
    { 0, 0, 0, 0, 0, 0, 0, 0, -2.5, -8.33333, 0, 0, 23.3333, -2.5, 0, 0 },
    { 0, 0, 0, 0, 0, 0, 0, 0, -8.33333, -8.33333, -8.33333, 0, -2.5, 40, -2.5, 0 },
    { 0, 0, 0, 0, 0, 0, 0, 0, 0, -8.33333, -8.33334, -8.33333, 0, -2.5, 40, -2.5 },
    { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -8.33333, -2.5, 0, 0, -2.5, 23.3333 }
};


TEST(Global_H_MatrixTest, GeneratesValidMatrixFor_Test1_4_4)
{
    // Given
    Simulation simulation(FileTypeEnum::TEXT, "../../../Input/Grids/Test1_4_4.txt");

    // When
    simulation.Run();

    // Then
    for (int i = 0; i < 16; i++) for (int j = 0; j < 16; j++)
        EXPECT_NEAR(globalHMatrixFixture[i][j], simulation.m_Grid.m_GlobalHMatrix.GetElement(i, j), EPSILON);
}
